Function GetMySQLData()
    Dim objShell As Object
    Dim objExec As Object
    Dim strCmd As String
    Dim strOutput As String
    Dim line As String
    
    ' Construct PowerShell command to connect and run query
    strCmd = "powershell -ExecutionPolicy Bypass -NoProfile -Command " & _
             """$conn = New-Object MySql.Data.MySqlClient.MySqlConnection;" & _
             "$conn.ConnectionString='server=your_server;user=your_user;password=your_password;database=your_database';" & _
             "$conn.Open();" & _
             "$cmd = $conn.CreateCommand();" & _
             "$cmd.CommandText='SELECT * FROM your_table';" & _
             "$reader = $cmd.ExecuteReader();" & _
             "while ($reader.Read()) { Write-Host $reader['column_name'] };" & _
             "$reader.Close();" & _
             "$conn.Close();"""

    ' Execute PowerShell script
    Set objShell = CreateObject("WScript.Shell")
    Set objExec = objShell.Exec(strCmd)

    ' Read output line by line
    Do While Not objExec.StdOut.AtEndOfStream
        line = objExec.StdOut.ReadLine()
        strOutput = strOutput & line & vbNewLine
    Loop

    ' Return the result
    GetMySQLData = strOutput
End Function

