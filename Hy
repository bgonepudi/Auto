Sub ListJSONFiles()
    Dim folderPath As String
    Dim fileSystem As Object
    Dim folder As Object
    Dim file As Object
    Dim i As Long
    Dim ws As Worksheet

    ' Get the folder path from cell D15
    folderPath = ThisWorkbook.Sheets("Sheet1").Range("D15").Value
    If Right(folderPath, 1) <> "\" Then folderPath = folderPath & "\"

    ' Create a new sheet
    Sheets.Add(After:=Sheets(Sheets.Count)).Name = "JSON Files"
    Set ws = Sheets("JSON Files")

    ' Set up headers
    ws.Cells(1, 1).Value = "File Name"
    ws.Cells(1, 2).Value = "File Path"

    ' Initialize row counter
    i = 2

    ' Set up file system object
    Set fileSystem = CreateObject("Scripting.FileSystemObject")
    Set folder = fileSystem.GetFolder(folderPath)

    ' Loop through each file in the folder
    For Each file In folder.Files
        If fileSystem.GetExtensionName(file.Name) = "json" Then
            ws.Cells(i, 1).Value = file.Name
            ws.Cells(i, 2).Value = file.Path
            i = i + 1
        End If
    Next file

    MsgBox "JSON file list generated successfully!", vbInformation
End Sub
