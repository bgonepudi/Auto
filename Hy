Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Me.Range("C:C")) Is Nothing Then
        UpdateYCount
    End If
End Sub

Private Sub UpdateYCount()
    Dim ws As Worksheet
    Dim cell As Range
    Dim countY As Long
    
    Set ws = ThisWorkbook.Sheets("JSON Files") ' Ensure this matches your sheet name
    
    countY = 0
    For Each cell In ws.Range("C2:C" & ws.Cells(ws.Rows.Count, "C").End(xlUp).Row)
        If cell.Value = "Y" Then
            countY = countY + 1
        End If
    Next cell
    
    ' Update the display or a specific cell with the count
    ws.Range("B2").Value = "Total items with Y: " & countY ' Adjust the cell reference as needed

    ' Auto size the columns
    ws.Columns("A:C").AutoFit
    
    ' Update the shape text
    Dim shp As Shape
    For Each shp In ws.Shapes
        If shp.Type = msoTextBox Then
            If InStr(1, shp.TextFrame.Characters.Text, "Total items with Y", vbTextCompare) > 0 Then
                shp.TextFrame.Characters.Text = "Total items with Y: " & countY
            End If
        End If
    Next shp
End Sub
