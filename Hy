# Load the Selenium Grid Console webpage
$gridUrl = "http://your-grid-console-url/grid/console"
$webClient = New-Object System.Net.WebClient
$pageContent = $webClient.DownloadString($gridUrl)

# Regex patterns to extract IP addresses and Chrome browser statuses
$ipRegex = [regex]::new('id : http://([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+):')
$chromeStatusRegex = [regex]::new('<img src="/grid/resources/org/openqa/grid/images/chrome\.png".+?title="seleniumProtocol=WebDriver"')

# Find all IP addresses
$ipMatches = $ipRegex.Matches($pageContent)

# Create an array to store results
$results = @()

# Iterate through the IP addresses
foreach ($ipMatch in $ipMatches) {
    $ip = $ipMatch.Groups[1].Value
    
    # Find Chrome browser instances associated with this IP
    $chromeCount = ($pageContent -match "<p>Browsers.*?WebDriver.*?$ip.*?chrome.png" | Measure-Object).Count
    
    # Add the result to the array
    $results += [PSCustomObject]@{
        "IP Address" = $ip
        "Chrome Browser Instances" = $chromeCount
        "Status" = if ($chromeCount -gt 0) { "Available" } else { "Unavailable" }
    }
}

# Output the results as a table
$results | Format-Table -AutoSize
