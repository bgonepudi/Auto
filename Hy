# Load the JSON file content
$jsonFilePath = "path_to_your_json_file.json"
$jsonContent = Get-Content -Raw -Path $jsonFilePath | ConvertFrom-Json

# Create a new custom object to hold the combined structure
$finalContent = [PSCustomObject]@{}

# Iterate through each property in the JSON content
foreach ($key in $jsonContent.PSObject.Properties.Name) {
    if ($key -match "^(.*?)\.(.+)$") {
        $prefix = $matches[1]
        $subKey = $matches[2]

        # Initialize the combined structure if it doesn't exist
        if (-not $finalContent.PSObject.Properties.Match($prefix)) {
            $finalContent | Add-Member -MemberType NoteProperty -Name $prefix -Value ([PSCustomObject]@{})
        }

        # Add the subKey and its value to the combined structure
        $finalContent.$prefix | Add-Member -MemberType NoteProperty -Name $subKey -Value $jsonContent.$key
    } else {
        # If the key doesn't have a period, add it directly to the final content
        $finalContent | Add-Member -MemberType NoteProperty -Name $key -Value $jsonContent.$key
    }
}

# Convert the updated structure back to JSON
$formattedJson = $finalContent | ConvertTo-Json -Depth 10

# Save the formatted JSON back to a file
$formattedJsonFilePath = "path_to_save_updated_json.json"
$formattedJson | Set-Content -Path $formattedJsonFilePath
