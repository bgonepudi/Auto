# Load the JSON file content
$jsonFilePath = "path_to_your_json_file.json"
$jsonContent = Get-Content -Raw -Path $jsonFilePath | ConvertFrom-Json

# Create a new hashtable to hold the combined structure
$combinedData = @{}

# Iterate through each property in the JSON content
foreach ($key in $jsonContent.PSObject.Properties.Name) {
    if ($key -match "^(.*?)\.(.+)$") {
        $prefix = $matches[1]
        $subKey = $matches[2]

        # Initialize the combined structure if it doesn't exist
        if (-not $combinedData.ContainsKey($prefix)) {
            $combinedData[$prefix] = @{}
        }

        # Add the subKey and its value to the combined structure
        $combinedData[$prefix][$subKey] = $jsonContent.$key

        # Remove the original key from the JSON content
        $jsonContent.PSObject.Properties.Remove($key)
    } else {
        # If the key doesn't have a period, add it directly to the combined structure
        $combinedData[$key] = $jsonContent.$key
    }
}

# Add the combined structure back to the main content
foreach ($prefix in $combinedData.Keys) {
    $jsonContent.PSObject.Properties.Add($prefix, $combinedData[$prefix])
}

# Convert the updated structure back to JSON
$formattedJson = $jsonContent | ConvertTo-Json -Depth 10

# Save the formatted JSON back to a file
$formattedJsonFilePath = "path_to_save_updated_json.json"
$formattedJson | Set-Content -Path $formattedJsonFilePath
