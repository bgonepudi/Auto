import pyodbc
import pandas as pd

# Connect to first server using Windows authentication
conn1 = pyodbc.connect('DRIVER={SQL Server};'
                       'SERVER=Server1;'
                       'DATABASE=Database1;'
                       'Trusted_Connection=yes;')

# Connect to second server using Windows authentication
conn2 = pyodbc.connect('DRIVER={SQL Server};'
                       'SERVER=Server2;'
                       'DATABASE=Database2;'
                       'Trusted_Connection=yes;')

# Fetch data from both tables
query = 'SELECT * FROM TableName ORDER BY PrimaryKeyColumn'
df1 = pd.read_sql(query, conn1)
df2 = pd.read_sql(query, conn2)

# Ensure column names are aligned (if necessary)
df1.columns = df2.columns

# Compare tables
comparison = df1.compare(df2)

# Print the comparison result
print(comparison)
