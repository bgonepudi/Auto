# Load the Selenium Grid Console webpage
$gridUrl = "http://your-grid-console-url/grid/console"
$webClient = New-Object System.Net.WebClient
$pageContent = $webClient.DownloadString($gridUrl)

# Regex pattern to extract IP addresses
$ipRegex = [regex]::new('id : http://([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+):')
$ipMatches = $ipRegex.Matches($pageContent)

# Regex pattern to find the status of Chrome browsers
$chromeStatusRegex = [regex]::new('<img src="/grid/resources/org/openqa/grid/images/chrome\.png".+?title="seleniumProtocol=WebDriver".+?>')
$chromeStatusMatches = $chromeStatusRegex.Matches($pageContent)

# Create an array to store results
$results = @()

# Iterate through the IP addresses and match with the Chrome browser statuses
for ($i = 0; $i -lt $ipMatches.Count; $i++) {
    $ip = $ipMatches[$i].Groups[1].Value
    $chromeIconsCount = ($chromeStatusMatches | Measure-Object).Count

    # Add the result to the array
    $results += [PSCustomObject]@{
        "IP Address" = $ip
        "Chrome Browser Instances" = $chromeIconsCount
        "Status" = "Available"  # Assuming the presence of icons implies availability
    }
}

# Output the results as a table
$results | Format-Table -AutoSize
