  # Process the results
            while ($reader.Read()) {
                # Initialize a hashtable to store the current row
                $result = @{}
                
                # Loop through each column in the reader and add it to the hashtable
                for ($i = 0; $i -lt $reader.FieldCount; $i++) {
                    $columnName = $reader.GetName($i)
                    $columnValue = $reader[$i]
                    $result[$columnName] = $columnValue
                }
                
                # Add region-related information to the result
                $result["Region"] = $regionName
                $result["GRGR_NAME"] = $grgr_name
                $result["GRGR_ID"] = $grgr_id
                $result["GRGR_STATE"] = $grgr_state
                $result["Run"] = $run
                
                # Add the row to the output data array
                $outputData += [PSCustomObject]$result
            }
            
            # Close the SQL connection
            $connection.Close()
        }
    }
}

# Display the data in a table format in the console
$outputData | Format-Table -AutoSize

# Optionally, export the results to​⬤
