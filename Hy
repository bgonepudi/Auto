# Dynamic data
$totalSegments = 395828
$passedSegments = 395362
$failedSegments = 466
$overallStatus = if ($failedSegments -eq 0) { "Pass" } else { "Fail" }

# HTML email body
$Body = @"
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #dddddd; text-align: left; padding: 8px; }
        th { background-color: #f4f4f4; }
        .fail { color: red; font-weight: bold; }
        .pass { color: green; font-weight: bold; }
        .footer { font-size: 12px; color: #777; margin-top: 20px; }
    </style>
</head>
<body>
    <p>Hi Team,</p>
    <p>We have executed the TPL File Validation script. Please find the test summary below:</p>
    <table>
        <tr>
            <th>Metric</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Total Segments Compared</td>
            <td>$totalSegments</td>
        </tr>
        <tr>
            <td>Segments Passed</td>
            <td>$passedSegments</td>
        </tr>
        <tr>
            <td>Segments Failed</td>
            <td>$failedSegments</td>
        </tr>
        <tr>
            <td>Overall Status</td>
            <td class="$([string]::Join(' ', $overallStatus.ToLower()))">$overallStatus</td>
        </tr>
    </table>
    <p>If you have any questions, please feel free to reach out to the Test Automation team at 
        <a href="mailto:ISQAAutomation@amerihealthcaritas.com">ISQAAutomation@amerihealthcaritas.com</a>.</p>
    <p class="footer">Thanks,<br>Test Automation Team</p>
</body>
</html>
"@
