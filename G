SELECT 
    YEAR(R.RN_EXECUTION_DATE) AS Run_Year,
    SUM(CASE WHEN T.TS_NAME LIKE 'TA_%' OR R.RN_TEST_CONFIG LIKE 'TA_%' THEN 1 ELSE 0 END) AS Automated_Count,
    SUM(CASE WHEN T.TS_NAME NOT LIKE 'TA_%' AND (R.RN_TEST_CONFIG IS NULL OR R.RN_TEST_CONFIG NOT LIKE 'TA_%') THEN 1 ELSE 0 END) AS Manual_Count
FROM [amfc_isqat_db].[td].[RUN] R
JOIN [amfc_isqat_db].[td].[TEST] T ON R.RN_TEST_ID = T.TS_TEST_ID
WHERE R.RN_STATUS IN ('Passed', 'Failed')
GROUP BY YEAR(R.RN_EXECUTION_DATE)
ORDER BY Run_Year;
